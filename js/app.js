document.getElementById('show-btn').addEventListener('click',toggleSidebar);function toggleSidebar(){var sB=document.getElementById('sidebar');if(sB.style.display==="none"){sB.style.display="block";}else{sB.style.display="none";}} var api="http://api.openweathermap.org/data/2.5/weather?lat=35.218939&lon=-80.842209&?id=524901&units=imperial&APPID=c23f6d23795d6a47a309155e714da031";$.ajax(api).done(function(result){var temp=result.main.temp.toFixed(0);var sky=result.weather[0].main;var weatherString='<span>Weather: '+temp+'Â°'+' & '+sky+'</span>';viewModel.weather(weatherString);}).fail(function(error){alert('OOPS! Weather info failed to load, refresh browser or try again later.');});var Brewery=function(data){var self=this;this.name=data.name;this.address=data.address;this.hood=data.hood+" "+" ";this.style='Style: '+data.style;this.website='<a href="'+data.website+'" target="blank">Go to Website</a>';this.icon=data.icon;this.marker=new google.maps.Marker({position:data.ll,map:map,icon:data.mapicon,animation:google.maps.Animation.DROP,});this.marker.addListener('click',function(){var marker=this;infowindow.setContent(self.brewInfoString);infowindow.open(map,this);setTimeout(function(){infowindow.close(map,this.marker);},10000);marker.setAnimation(google.maps.Animation.BOUNCE);setTimeout(function(){marker.setAnimation(null);},806);});this.brewInfoString=makeInfoString(self);};function makeInfoString(data){var content='<div id="brewInfoWindow"><div id="brew-name"><em>'+data.name+'</em></div>'+'<div>'+data.address+'</div>'+'<div>'+data.hood+'</div>'+'<div>'+data.website+'</div></div>';return content;} var ViewModel=function(){var self=this;this.breweries=ko.observableArray();this.weather=ko.observable('');this.filterInput=ko.observable('');for(var i=0;i<brewers.length;i++){this.breweries.push(new Brewery(brewers[i]));} var bounds=new google.maps.LatLngBounds();this.breweries().forEach(function(brewery){bounds.extend(brewery.marker.position);}) map.fitBounds(bounds);self.filterBrew=ko.computed(function(){var filter=self.filterInput().toLowerCase();return ko.utils.arrayFilter(self.breweries(),function(brewery){var match=brewery.name.toLowerCase().indexOf(filter)!==-1||brewery.hood.toLowerCase().indexOf(filter)!==-1||brewery.style.toLowerCase().indexOf(filter)!==-1;brewery.marker.setVisible(match);return match;});});self.showWindow=function(){infowindow.setContent(this.brewInfoString);infowindow.open(map,this.marker);setTimeout(function(){infowindow.close(map,this.marker);},10000);};};var map;var infowindow;var markers=[];var viewModel;function initMap(){infowindow=new google.maps.InfoWindow();map=new google.maps.Map(document.getElementById('map'),{center:{lat:35.218939,lng:-80.842209},zoom:13,mapTypeControl:false,styles:[{stylers:[{saturation:-100}]}]});function mapError(){alert('Error loading Google Maps. Check internet connection. Please try again later');} viewModel=new ViewModel() ko.applyBindings(viewModel);}
